

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Solving forward problems with FastVPINNs : Poisson - 2D &mdash; fastvpinns 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css?v=76b2166b" />

  
      <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../../../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="../../../../../_static/copybutton.js?v=f281be69"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="Solving forward problems with FastVPINNs : Helmholtz - 2D" href="../helmholtz_2d/helmholtz2d_uniform.html" />
    <link rel="prev" title="FastVPINNs Tutorials" href="../../../../_tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html">
            
              <img src="../../../../../_static/Fastvpinns_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../_installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../_docker.html">Docker Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example-Problems</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../../_tutorial.html">  Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../../_tutorial.html#forward-problems">Forward Problems</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../../../_tutorial.html#problems-on-uniform-mesh">Problems on Uniform Mesh</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#"> Poisson Equation on unit square</a></li>
<li class="toctree-l4"><a class="reference internal" href="../helmholtz_2d/helmholtz2d_uniform.html"> Helmholtz Equation on unit square</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../../_tutorial.html#problems-on-complex-geometry">Problems on Complex geometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../_tutorial.html#problems-with-hard-boundary-constraints">Problems with Hard boundary constraints</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../_tutorial.html#custom-training">Custom Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../_tutorial.html#inverse-problems">Inverse Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../_tutorial.html#mesh-generation-tutorials">Mesh Generation Tutorials</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../fastvpinns.html">fastvpinns</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../_licence.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../_contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../_cite.html">Cite FastVPINNs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../_team.html">Team &amp; Fundings</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">fastvpinns</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../_tutorial.html">FastVPINNs Tutorials</a></li>
      <li class="breadcrumb-item active">Solving forward problems with FastVPINNs : Poisson - 2D</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../../_sources/_rst/tutorials/forward_problems_2d/uniform_mesh/poisson_2d/poisson2d_uniform.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="solving-forward-problems-with-fastvpinns-poisson-2d">
<h1>Solving forward problems with FastVPINNs : Poisson - 2D<a class="headerlink" href="#solving-forward-problems-with-fastvpinns-poisson-2d" title="Link to this heading"></a></h1>
<p>In this example, we will learn how to solve a 2-dimensional Poisson problem using FastVPINNs.
All the necessary files can be found in the examples folder of the <a class="reference external" href="https://github.com/cmgcds/fastvpinns">fastvpinns GitHub repository</a></p>
<div class="math notranslate nohighlight">
\[-\varepsilon\Delta u(x) = f(x), \quad \ x \in \Omega = (0, 1)^2\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[f(x,y) = -2\omega^2 \sin{\omega x} \sin{\omega y}\]</div>
<p>For an <span class="math notranslate nohighlight">\(\varepsilon = 1\)</span>, and considering <span class="math notranslate nohighlight">\(\omega = 2 \pi\)</span> the
exact solution is given by</p>
<div class="math notranslate nohighlight">
\[u(x,y) = -\sin{2 \pi x}\sin{2 \pi y}\]</div>
<p>We begin by introducing the various files required to run this example</p>
<section id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#steps-to-run-the-code">Steps to run the code</a></p></li>
<li><p><a class="reference external" href="#example-file">Example File</a></p>
<ul>
<li><p><a class="reference external" href="#defining-the-boundary-values">Defining the boundary values</a></p></li>
<li><p><a class="reference external" href="#defining-the-forcing-function">Defining the forcing function</a></p></li>
<li><p><a class="reference external" href="#defining-the-bilinear-parameters">Defining the bilinear parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#input-file">Input File</a></p>
<ul>
<li><p><a class="reference external" href="#experimentation-parameters">Experimentation parameters</a></p></li>
<li><p><a class="reference external" href="#geometry-parameters">Geometry parameters</a></p></li>
<li><p><a class="reference external" href="#finite-element-space-parameters">Finite element space parameters</a></p></li>
<li><p><a class="reference external" href="#pde-beta-parameters">PDE Beta parameters</a></p></li>
<li><p><a class="reference external" href="#model-parameters">Model parameters</a></p></li>
<li><p><a class="reference external" href="#logging-parameters">Logging parameters</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#main-file">Main File</a></p>
<ul>
<li><p><a class="reference external" href="#import-relevant-fastvpinns-methods">Import relevant FastVPINNs methods</a></p></li>
<li><p><a class="reference external" href="#reading-the-input-file">Reading the Input File</a></p></li>
<li><p><a class="reference external" href="#setting-up-the-geometry2d-object">Setting up the Geometry2D object</a></p></li>
<li><p><a class="reference external" href="#reading-the-boundary-conditions-and-values">Reading the boundary conditions and values</a></p></li>
<li><p><a class="reference external" href="#setting-up-the-finite-element-space">Setting up the finite element space</a></p></li>
<li><p><a class="reference external" href="#instantiating-the-model">Instantiating the model</a></p></li>
<li><p><a class="reference external" href="#training-the-model">Training the model</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#solution">Solution</a></p></li>
<li><p><a class="reference external" href="#references">References</a></p></li>
</ul>
</section>
<section id="steps-to-run-the-code">
<h2>Steps to run the code<a class="headerlink" href="#steps-to-run-the-code" title="Link to this heading"></a></h2>
<p>To run the code, execute the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>main_poisson2d_hard.py<span class="w"> </span>input.yaml
</pre></div>
</div>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="example-file">
<h2>Example file<a class="headerlink" href="#example-file" title="Link to this heading"></a></h2>
<p>The example file, <code class="docutils literal notranslate"><span class="pre">sin_cos.py</span></code>, defines the boundary values,
the forcing function and exact function (if test error needs
to be calculated), bilinear parameters and the actual value of
the parameter that needs to be estimated (if the error between
the actual and estimated parameter needs to be calculated).</p>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
<section id="defining-the-boundary-values">
<h3>Defining the boundary values<a class="headerlink" href="#defining-the-boundary-values" title="Link to this heading"></a></h3>
<p>Boundary values are defined using the functions <code class="docutils literal notranslate"><span class="pre">get_boundary_function_dict</span></code> and <code class="docutils literal notranslate"><span class="pre">get_bound_cond_dict</span></code>.</p>
<figure class="align-center">
<img alt="Unit Square" src="../../../../../_images/rect2.png" />
</figure>
<p>For internally generated geometries, the boundary IDs will be hard-coded to
1000  for bottom, 1001 for right, 1002 for top, and 1003 for left; as shown in the figure.</p>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="defining-the-forcing-function">
<h3>Defining the forcing function<a class="headerlink" href="#defining-the-forcing-function" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">rhs</span></code> can be used to define the forcing function <span class="math notranslate nohighlight">\(f\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">rhs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function will return the value of the rhs at a given point</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">omegaX</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">omegaY</span> <span class="o">=</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">f_temp</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">omegaX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omegaX</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omegaY</span> <span class="o">*</span> <span class="n">y</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">f_temp</span>
</pre></div>
</div>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="defining-the-bilinear-parameters">
<h3>Defining the bilinear parameters<a class="headerlink" href="#defining-the-bilinear-parameters" title="Link to this heading"></a></h3>
<p>The bilinear parameters like diffusion constant can be defined by
<code class="docutils literal notranslate"><span class="pre">get_bilinear_params_dict</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_bilinear_params_dict</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function will return a dictionary of bilinear parameters</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;eps&quot;</span><span class="p">:</span> <span class="n">eps</span><span class="p">}</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">eps</span></code> denotes the diffusion constant.</p>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
</section>
<section id="input-file">
<h2>Input file<a class="headerlink" href="#input-file" title="Link to this heading"></a></h2>
<p>The input file <code class="docutils literal notranslate"><span class="pre">input.yaml</span></code>, is used to define inputs to your solver.
These are the usual parameters that are changed often throughout your
experimentation, hence it is best practice to pass these parameters
externally. The input file is divided based on the modules which use the
parameter.</p>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
<section id="experimentation-parameters">
<h3>Experimentation parameters<a class="headerlink" href="#experimentation-parameters" title="Link to this heading"></a></h3>
<p>Defines the output path where the results will be saved.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">experimentation</span><span class="p">:</span>
<span class="w">  </span><span class="nt">output_path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;output/poisson2d/1&quot;</span><span class="w">  </span><span class="c1"># Path to the output directory where the results will be saved.</span>
</pre></div>
</div>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="geometry-parameters">
<h3>Geometry parameters<a class="headerlink" href="#geometry-parameters" title="Link to this heading"></a></h3>
<p>This section defines the geometrical parameters for your domain.</p>
<ul class="simple">
<li><p>In this example, we set the <code class="docutils literal notranslate"><span class="pre">mesh_generation_method</span></code> as <code class="docutils literal notranslate"><span class="pre">&quot;internal&quot;</span></code>.
This generates a regular quadrilateral domain with a uniform mesh.</p></li>
<li><p>The parameters in <code class="docutils literal notranslate"><span class="pre">internal_mesh_params</span></code> define the x and y limits of
the quadrilateral domain(<code class="docutils literal notranslate"><span class="pre">xmin</span></code>, <code class="docutils literal notranslate"><span class="pre">xmax</span></code>, <code class="docutils literal notranslate"><span class="pre">ymin</span></code> and <code class="docutils literal notranslate"><span class="pre">ymax</span></code>),
number of cells in the domain in the x and y direction (<code class="docutils literal notranslate"><span class="pre">n_cells_x</span></code>
and <code class="docutils literal notranslate"><span class="pre">n_cells_y</span></code>), number of total boundary points
(<code class="docutils literal notranslate"><span class="pre">n_boundary_points</span></code>) and number of test points in x and y direction
(<code class="docutils literal notranslate"><span class="pre">n_test_points_x</span></code> and <code class="docutils literal notranslate"><span class="pre">n_test_points_y</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mesh_type</span></code> is set to “quadrilateral” which means that the mesh is
a quadrilateral mesh. Note: FastVPINNs currently provides support for quadrilateral elements only.
So, <code class="docutils literal notranslate"><span class="pre">mesh_type</span></code> is set to quadrilateral.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">boundary_sampling_method</span></code> is set to “uniform” which means that the
boundary points are sampled using the “uniform” method. (Use only
uniform sampling as of now.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">external_mesh_params</span></code> can be used to specify parameters for the
external mesh, and can be ignored for this example.</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">geometry</span><span class="p">:</span>
<span class="w">   </span><span class="nt">mesh_generation_method</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;internal&quot;</span><span class="w">  </span><span class="c1"># Method for generating the mesh. Can be &quot;internal&quot; or &quot;external&quot;.</span>
<span class="w">   </span><span class="nt">generate_mesh_plot</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">True</span><span class="w">  </span><span class="c1"># Flag indicating whether to generate a plot of the mesh.</span>

<span class="w">   </span><span class="c1"># internal mesh generated quadrilateral mesh, depending on the parameters specified below.</span>

<span class="w">   </span><span class="nt">internal_mesh_params</span><span class="p">:</span><span class="w">  </span><span class="c1"># Parameters for internal mesh generation method.</span>
<span class="w">      </span><span class="nt">x_min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w">  </span><span class="c1"># Minimum x-coordinate of the domain.</span>
<span class="w">      </span><span class="nt">x_max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">  </span><span class="c1"># Maximum x-coordinate of the domain.</span>
<span class="w">      </span><span class="nt">y_min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span><span class="w">  </span><span class="c1"># Minimum y-coordinate of the domain.</span>
<span class="w">      </span><span class="nt">y_max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span><span class="w">  </span><span class="c1"># Maximum y-coordinate of the domain.</span>
<span class="w">      </span><span class="nt">n_cells_x</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span><span class="w">  </span><span class="c1"># Number of cells in the x-direction.</span>
<span class="w">      </span><span class="nt">n_cells_y</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span><span class="w">  </span><span class="c1"># Number of cells in the y-direction.</span>
<span class="w">      </span><span class="nt">n_boundary_points</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">400</span><span class="w">  </span><span class="c1"># Number of boundary points.</span>
<span class="w">      </span><span class="nt">n_test_points_x</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span><span class="w">  </span><span class="c1"># Number of test points in the x-direction.</span>
<span class="w">      </span><span class="nt">n_test_points_y</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span><span class="w">  </span><span class="c1"># Number of test points in the y-direction.</span>

<span class="w">   </span><span class="nt">exact_solution</span><span class="p">:</span>
<span class="w">      </span><span class="nt">exact_solution_generation</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;internal&quot;</span><span class="w"> </span><span class="c1"># whether the exact solution needs to be read from external file.</span>
<span class="w">      </span><span class="nt">exact_solution_file_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;fem_solutions/neumann_solutions/solution_problem_3.txt&quot;</span><span class="w"> </span><span class="c1"># External solution file name.</span>

<span class="w">   </span><span class="nt">mesh_type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;quadrilateral&quot;</span><span class="w">  </span><span class="c1"># Type of mesh. Can be &quot;quadrilateral&quot; or other supported types.</span>

<span class="w">   </span><span class="nt">external_mesh_params</span><span class="p">:</span><span class="w">  </span><span class="c1"># Parameters for external mesh generation method.</span>
<span class="w">      </span><span class="nt">mesh_file_name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;meshes/hemker.mesh&quot;</span><span class="w">  </span><span class="c1"># Path to the external mesh file (should be a .mesh file).</span>
<span class="w">      </span><span class="nt">boundary_refinement_level</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span><span class="w">  </span><span class="c1"># Level of refinement for the boundary.</span>
<span class="w">      </span><span class="nt">boundary_sampling_method</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;uniform&quot;</span><span class="w">  </span><span class="c1"># Method for sampling the boundary. Can be &quot;uniform&quot;</span>
</pre></div>
</div>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="finite-element-space-parameters">
<h3>Finite Element Space parameters<a class="headerlink" href="#finite-element-space-parameters" title="Link to this heading"></a></h3>
<p>The parameters related to the finite element space are defined here.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fe_order</span></code> sets the order of the finite element test functions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fe_type</span></code> set which type of polynomial will be used as the finite element test function.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quad_order</span></code> is the number of quadrature in each direction in each cell. Thus the total number of quadrature points in each cell will be (quad_order)<span class="math notranslate nohighlight">\(^2\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quad_type</span></code> specifies the quadrature rule to be used.</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">fe</span><span class="p">:</span>
<span class="w">  </span><span class="nt">fe_order</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">6</span><span class="w"> </span><span class="c1"># Order of the finite element basis functions.</span>
<span class="w">  </span><span class="nt">fe_type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;legendre&quot;</span><span class="w">  </span><span class="c1"># Type of finite element basis functions. Can be &quot;jacobi&quot; or other supported types.</span>
<span class="w">  </span><span class="nt">quad_order</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w">  </span><span class="c1"># Order of the quadrature rule.</span>
<span class="w">  </span><span class="nt">quad_type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gauss-jacobi&quot;</span><span class="w">  </span><span class="c1"># Type of quadrature rule. Can be &quot;gauss-jacobi&quot; or other supported types.</span>
</pre></div>
</div>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="pde-beta-parameters">
<h3>PDE beta parameters<a class="headerlink" href="#pde-beta-parameters" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">beta</span></code> specifies the weight by which the boundary loss will be
multiplied before being added to the PDE loss.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">pde</span><span class="p">:</span>
<span class="w">  </span><span class="nt">beta</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w">  </span><span class="c1"># Parameter for the PDE.</span>
</pre></div>
</div>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="model-parameters">
<h3>Model parameters<a class="headerlink" href="#model-parameters" title="Link to this heading"></a></h3>
<p>The parameters pertaining to the neural network are specified here.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">model_architecture</span></code> is used to specify the dimensions of the neural network. In this example, [2, 50, 50, 50, 1] corresponds to a neural network with 2 inputs (for a 2-dimensional problem), 1 output (for a scalar problem) and 3 hidden layers with 30 neurons each.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">activation</span></code> specifies the activation function to be used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">use_attention</span></code> specifies if attention layers are to be used in the model. This feature is currently under development and hence should be set to <code class="docutils literal notranslate"><span class="pre">false</span></code> for now.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">epochs</span></code> is the number of iterations for which the network must be trained.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dtype</span></code> specifies which datatype (<code class="docutils literal notranslate"><span class="pre">float32</span></code> or <code class="docutils literal notranslate"><span class="pre">float64</span></code>) will be used for the tensor calculations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_memory_growth</span></code>, when set to <code class="docutils literal notranslate"><span class="pre">True</span></code> will enable tensorflow’s memory growth function, restricting the memory usage on the GPU. This is currently under development and must be set to <code class="docutils literal notranslate"><span class="pre">False</span></code> for now.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">learning_rate</span></code> sets the learning rate <code class="docutils literal notranslate"><span class="pre">initial_learning_rate</span></code> if a constant learning rate is used.</p></li>
<li><p>A learning rate scheduler can be used by toggling <code class="docutils literal notranslate"><span class="pre">use_lr_scheduler</span></code> to True and setting the corresponding decay parameters below it. The <code class="docutils literal notranslate"><span class="pre">decay_steps</span></code> parameter is the number of steps between each learning rate decay. The <code class="docutils literal notranslate"><span class="pre">decay_rate</span></code> parameter is the decay rate for the learning rate. The <code class="docutils literal notranslate"><span class="pre">staircase</span></code> parameter is a flag indicating whether to use the staircase decay.</p></li>
</ul>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">model</span><span class="p">:</span>
<span class="w">   </span><span class="nt">model_architecture</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">50</span><span class="p p-Indicator">,</span><span class="nv">50</span><span class="p p-Indicator">,</span><span class="nv">50</span><span class="p p-Indicator">,</span><span class="nv">50</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1</span><span class="p p-Indicator">]</span><span class="w">  </span><span class="c1"># Architecture of the neural network model.</span>
<span class="w">   </span><span class="nt">activation</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tanh&quot;</span><span class="w">  </span><span class="c1"># Activation function used in the neural network.</span>
<span class="w">   </span><span class="nt">use_attention</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w">  </span><span class="c1"># Flag indicating whether to use attention mechanism in the model.</span>
<span class="w">   </span><span class="nt">epochs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span><span class="w">  </span><span class="c1"># Number of training epochs.</span>
<span class="w">   </span><span class="nt">dtype</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;float32&quot;</span><span class="w">  </span><span class="c1"># Data type used for computations.</span>
<span class="w">   </span><span class="nt">set_memory_growth</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w">  </span><span class="c1"># Flag indicating whether to set memory growth for GPU.</span>

<span class="w">   </span><span class="nt">learning_rate</span><span class="p">:</span><span class="w">  </span><span class="c1"># Parameters for learning rate scheduling.</span>
<span class="w">      </span><span class="nt">initial_learning_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span><span class="w">  </span><span class="c1"># Initial learning rate.</span>
<span class="w">      </span><span class="nt">use_lr_scheduler</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w">  </span><span class="c1"># Flag indicating whether to use learning rate scheduler.</span>
<span class="w">      </span><span class="nt">decay_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span><span class="w">  </span><span class="c1"># Number of steps between each learning rate decay.</span>
<span class="w">      </span><span class="nt">decay_rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.99</span><span class="w">  </span><span class="c1"># Decay rate for the learning rate.</span>
<span class="w">      </span><span class="nt">staircase</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span><span class="w">  </span><span class="c1"># Flag indicating whether to use staircase decay.</span>
</pre></div>
</div>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="logging-parameters">
<h3>Logging parameters<a class="headerlink" href="#logging-parameters" title="Link to this heading"></a></h3>
<p>It specifies the frequency with which the progress bar and console
output will be updated, and at what interval will inference be carried
out to print the solution image in the output folder.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">logging</span><span class="p">:</span>
<span class="w">  </span><span class="nt">update_console_output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span><span class="w">  </span><span class="c1"># Number of steps between each update of the console output.</span>
</pre></div>
</div>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
</section>
<section id="main-file">
<h2>Main file<a class="headerlink" href="#main-file" title="Link to this heading"></a></h2>
<p>The main file <code class="docutils literal notranslate"><span class="pre">main_poisson_2d.py</span></code> which needs to be run for the experiment, with the
input file as an argument.</p>
<p>Following are the key components of a FastVPINNs main file</p>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
<section id="import-relevant-fastvpinns-methods">
<h3>Import relevant FastVPINNs methods<a class="headerlink" href="#import-relevant-fastvpinns-methods" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">fastvpinns.data.datahandler2d</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataHandler2D</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fastvpinns.FE.fespace2d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fespace2D</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fastvpinns.Geometry.geometry_2d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Geometry_2D</span>
</pre></div>
</div>
<p>Will import the functions related to setting up the finite element
space, the 2D Geometry and the datahandler required to manage data and make
it available to the model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">fastvpinns.model.modelimport</span> <span class="n">DenseModel</span>
</pre></div>
</div>
<p>Will import the model file where the neural network and its training
function is defined. The model file <code class="docutils literal notranslate"><span class="pre">model.py</span></code> contains the
<code class="docutils literal notranslate"><span class="pre">DenseModel</span></code> class. The <code class="docutils literal notranslate"><span class="pre">train_step</span></code> function of this model is used
to train the model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">fastvpinns.physics.poisson2d</span><span class="w"> </span><span class="kn">import</span> <span class="n">pde_loss_poisson</span>
</pre></div>
</div>
<p>Will import the loss function for the 2-dimensional Poisson problem.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">fastvpinns.utils.compute_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">compute_errors_combined</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fastvpinns.utils.plot_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">plot_contour</span><span class="p">,</span> <span class="n">plot_loss_function</span><span class="p">,</span> <span class="n">plot_test_loss_function</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fastvpinns.utils.print_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">print_table</span>
</pre></div>
</div>
<p>Will import functions to calculate the loss, plot the results and print
outputs to the console.</p>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="reading-the-input-file">
<h3>Reading the Input File<a class="headerlink" href="#reading-the-input-file" title="Link to this heading"></a></h3>
<p>The input file is loaded into <code class="docutils literal notranslate"><span class="pre">config</span></code>, and the input parameters are
read and assigned to their respective variables.</p>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="setting-up-the-geometry2d-object">
<h3>Setting up the Geometry2D object<a class="headerlink" href="#setting-up-the-geometry2d-object" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">domain</span> <span class="o">=</span> <span class="n">Geometry_2D</span><span class="p">(</span><span class="n">i_mesh_type</span><span class="p">,</span> <span class="n">i_mesh_generation_method</span><span class="p">,</span> <span class="n">i_n_test_points_x</span><span class="p">,</span> <span class="n">i_n_test_points_y</span><span class="p">,</span> <span class="n">i_output_path</span><span class="p">)</span>
</pre></div>
</div>
<p>This will instantiate a <code class="docutils literal notranslate"><span class="pre">Geometry_2D</span></code> object <code class="docutils literal notranslate"><span class="pre">domain</span></code>, with the mesh
type, mesh generation method and test points. In our example, the mesh
generation method is <code class="docutils literal notranslate"><span class="pre">internal</span></code>, so the cells and boundary points will
be obtained using the <code class="docutils literal notranslate"><span class="pre">generate_quad_mesh_internal</span></code> method.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cells</span><span class="p">,</span> <span class="n">boundary_points</span> <span class="o">=</span> <span class="n">domain</span><span class="o">.</span><span class="n">generate_quad_mesh_internal</span><span class="p">(</span>
  <span class="n">x_limits</span><span class="o">=</span><span class="p">[</span><span class="n">i_x_min</span><span class="p">,</span> <span class="n">i_x_max</span><span class="p">],</span>
  <span class="n">y_limits</span><span class="o">=</span><span class="p">[</span><span class="n">i_y_min</span><span class="p">,</span> <span class="n">i_y_max</span><span class="p">],</span>
  <span class="n">n_cells_x</span><span class="o">=</span><span class="n">i_n_cells_x</span><span class="p">,</span>
  <span class="n">n_cells_y</span><span class="o">=</span><span class="n">i_n_cells_y</span><span class="p">,</span>
  <span class="n">num_boundary_points</span><span class="o">=</span><span class="n">i_n_boundary_points</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="reading-the-boundary-conditions-and-values">
<h3>Reading the boundary conditions and values<a class="headerlink" href="#reading-the-boundary-conditions-and-values" title="Link to this heading"></a></h3>
<p>As explained in the <a class="reference external" href="#example-file">example file section</a>
, the boundary conditions and values
are read as a dictionary from the example file</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">bound_function_dict</span><span class="p">,</span> <span class="n">bound_condition_dict</span> <span class="o">=</span> <span class="n">get_boundary_function_dict</span><span class="p">(),</span> <span class="n">get_bound_cond_dict</span><span class="p">()</span>
</pre></div>
</div>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="setting-up-the-finite-element-space">
<h3>Setting up the finite element space<a class="headerlink" href="#setting-up-the-finite-element-space" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fespace</span> <span class="o">=</span> <span class="n">Fespace2D</span><span class="p">(</span>
  <span class="n">mesh</span><span class="o">=</span><span class="n">domain</span><span class="o">.</span><span class="n">mesh</span><span class="p">,</span>
  <span class="n">cells</span><span class="o">=</span><span class="n">cells</span><span class="p">,</span>
  <span class="n">boundary_points</span><span class="o">=</span><span class="n">boundary_points</span><span class="p">,</span>
  <span class="n">cell_type</span><span class="o">=</span><span class="n">domain</span><span class="o">.</span><span class="n">mesh_type</span><span class="p">,</span>
  <span class="n">fe_order</span><span class="o">=</span><span class="n">i_fe_order</span><span class="p">,</span>
  <span class="n">fe_type</span><span class="o">=</span><span class="n">i_fe_type</span><span class="p">,</span>
  <span class="n">quad_order</span><span class="o">=</span><span class="n">i_quad_order</span><span class="p">,</span>
  <span class="n">quad_type</span><span class="o">=</span><span class="n">i_quad_type</span><span class="p">,</span>
  <span class="n">fe_transformation_type</span><span class="o">=</span><span class="s2">&quot;bilinear&quot;</span><span class="p">,</span>
  <span class="n">bound_function_dict</span><span class="o">=</span><span class="n">bound_function_dict</span><span class="p">,</span>
  <span class="n">bound_condition_dict</span><span class="o">=</span><span class="n">bound_condition_dict</span><span class="p">,</span>
  <span class="n">forcing_function</span><span class="o">=</span><span class="n">rhs</span><span class="p">,</span>
  <span class="n">output_path</span><span class="o">=</span><span class="n">i_output_path</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">fespace</span></code> will contain all the information about the finite element
space, including those read from the <a class="reference external" href="#input-file">input file</a></p>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="instantiating-the-model">
<h3>Instantiating the model<a class="headerlink" href="#instantiating-the-model" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">DenseModel</span><span class="p">(</span>
  <span class="n">layer_dims</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
  <span class="n">learning_rate_dict</span><span class="o">=</span><span class="n">i_learning_rate_dict</span><span class="p">,</span>
  <span class="n">params_dict</span><span class="o">=</span><span class="n">params_dict</span><span class="p">,</span>
  <span class="n">loss_function</span><span class="o">=</span><span class="n">pde_loss_poisson</span><span class="p">,</span>
  <span class="n">input_tensors_list</span><span class="o">=</span><span class="p">[</span><span class="n">datahandler</span><span class="o">.</span><span class="n">x_pde_list</span><span class="p">,</span> <span class="n">train_dirichlet_input</span><span class="p">,</span> <span class="n">train_dirichlet_output</span><span class="p">],</span>
  <span class="n">orig_factor_matrices</span><span class="o">=</span><span class="p">[</span>
    <span class="n">datahandler</span><span class="o">.</span><span class="n">shape_val_mat_list</span><span class="p">,</span>
    <span class="n">datahandler</span><span class="o">.</span><span class="n">grad_x_mat_list</span><span class="p">,</span>
    <span class="n">datahandler</span><span class="o">.</span><span class="n">grad_y_mat_list</span><span class="p">,</span>
   <span class="p">],</span>
  <span class="n">force_function_list</span><span class="o">=</span><span class="n">datahandler</span><span class="o">.</span><span class="n">forcing_function_list</span><span class="p">,</span>
  <span class="n">tensor_dtype</span><span class="o">=</span><span class="n">i_dtype</span><span class="p">,</span>
  <span class="n">use_attention</span><span class="o">=</span><span class="n">i_use_attention</span><span class="p">,</span>
  <span class="n">activation</span><span class="o">=</span><span class="n">i_activation</span><span class="p">,</span>
  <span class="n">hessian</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In this problem, we pass the loss function <code class="docutils literal notranslate"><span class="pre">pde_loss_poisson</span></code> from the
<code class="docutils literal notranslate"><span class="pre">physics</span></code> file of <code class="docutils literal notranslate"><span class="pre">poisson2d.py</span></code>.</p>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="training-the-model">
<h3>Training the model<a class="headerlink" href="#training-the-model" title="Link to this heading"></a></h3>
<p>We are now ready to train the model to approximate the solution of the
PDE.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>

  <span class="c1"># Train the model</span>
  <span class="n">batch_start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

  <span class="n">loss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">train_step</span><span class="p">(</span><span class="n">beta</span><span class="o">=</span><span class="n">beta</span><span class="p">,</span> <span class="n">bilinear_params_dict</span><span class="o">=</span><span class="n">bilinear_params_dict</span><span class="p">)</span>

  <span class="o">...</span>
</pre></div>
</div>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
</section>
<section id="solution">
<h2>Solution<a class="headerlink" href="#solution" title="Link to this heading"></a></h2>
<img alt="Exact Solution" class="align-center" src="../../../../../_images/exact_solution6.png" />
<img alt="Predicted Solution" class="align-center" src="../../../../../_images/predicted_solution6.png" />
<img alt="Error" class="align-center" src="../../../../../_images/error6.png" />
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://arxiv.org/abs/2404.12063">FastVPINNs: Tensor-Driven Acceleration of VPINNs for Complex
Geometries.</a></p></li>
</ol>
<p><a class="reference external" href="#contents">Back to Contents</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../../../../_tutorial.html" class="btn btn-neutral float-left" title="FastVPINNs Tutorials" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../helmholtz_2d/helmholtz2d_uniform.html" class="btn btn-neutral float-right" title="Solving forward problems with FastVPINNs : Helmholtz - 2D" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Thivin Anandh, Divij Ghose, Sashikumaar Ganesan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>