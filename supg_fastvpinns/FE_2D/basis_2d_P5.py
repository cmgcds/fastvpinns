
# Purpose: Defines the basis functions for a 2D P5 element.
# Reference: ParMooN -  File: BF_C_T_P5_2D.h
# Author: Thivin Anandh D
# Date: 17/Jan/2024

import numpy as np
from .basis_function_2d import BasisFunction2D

class Basis2DP5(BasisFunction2D):
    """
    This class defines the basis functions for a 2D P5 element.
    """
    def __init__(self):
        super().__init__(num_shape_functions=21)



    #  base function values
    
    def value(self, xi, eta):
        """
        This method returns the values of the basis functions at the given (xi, eta) coordinates.
        """
    

        t3, t5, t7, t9, t11, t13, t15, t18, t20, t22, t24, t26, t28, t29
        t30, t31, t32, t33, t34, t35, t36, t37, t38, t39, t40, t42, t44
        t46, t50, t52, t53, t54, t55, t56, t58, t63, t64, t65, t66, t67
        t70, t73, t76, t77, t80, t82, t84, t90, t93, t98, t99, t100, t101
        t102, t109, t110, t112, t116, t117, t119, t123, t129, t132, t133
        t134, t143, t148, t153, t162

        t3 = xi*xi
        t5 = xi*eta
        t7 = eta*eta
        t9 = t3*xi
        t11 = t3*eta
        t13 = xi*t7
        t15 = t7*eta
        t18 = t3*t3
        t20 = t9*eta
        t22 = t3*t7
        t24 = xi*t15
        t26 = t7*t7
        t28 = t18*xi
        t29 = 625.0/24.0*t28
        t30 = t18*eta
        t31 = 3125.0/24.0*t30
        t32 = t9*t7
        t33 = 3125.0/12.0*t32
        t34 = t3*t15
        t35 = 3125.0/12.0*t34
        t36 = xi*t26
        t37 = 3125.0/24.0*t36
        t38 = t26*eta
        t39 = 625.0/24.0*t38
        t40 = 625.0/8.0*t18+625.0/2.0*t20+1875.0/4.0*t22+625.0/2.0*t24+625.0/8.0*t26-t29-t31-t33-t35-t37-t39
        t42 = 25.0*xi
        t44 = 1925.0/12.0*t5
        t46 = 8875.0/12.0*t11
        t50 = 4375.0/4.0*t22
        t52 = 3125.0/24.0*t28
        t53 = 3125.0/6.0*t30
        t54 = 3125.0/4.0*t32
        t55 = 3125.0/6.0*t34
        t56 = t42-1925.0/12.0*t3-t44+8875.0/24.0*t9+t46+8875.0/24.0*t13-4375.0/12.0*t18-4375.0/4.0*t20-t50-4375.0/12.0*t24+t52+t53+t54+t55+t37
        t58 = 1175.0/12.0*t5
        t63 = 3125.0/4.0*t22
        t64 = 625.0/12.0*t24
        t65 = 3125.0/12.0*t28
        t66 = 3125.0/4.0*t30
        t67 = -t42+2675.0/12.0*t3+t58-7375.0/12.0*t9-t46-125.0*t13+8125.0/12.0*t18+5625.0/4.0*t20+t63+t64-t65-t66-t54-t35
        t70 = 75.0/2.0*t5
        t73 = 125.0/6.0*t13
        t76 = 625.0/4.0*t22
        t77 = 50.0/3.0*xi-325.0/2.0*t3-t70+6125.0/12.0*t9+3875.0/12.0*t11+t73-625.0*t18-3125.0/4.0*t20-t76+t65+t53+t33
        t80 = 25.0/4.0*t5
        t82 = 1375.0/24.0*t11
        t84 = 625.0/4.0*t20
        t90 = 25.0*eta
        t93 = 8875.0/12.0*t13
        t98 = 3125.0/6.0*t32
        t99 = 3125.0/4.0*t34
        t100 = 3125.0/6.0*t36
        t101 = 3125.0/24.0*t38
        t102 = t90-t44-1925.0/12.0*t7+8875.0/24.0*t11+t93+8875.0/24.0*t15-4375.0/12.0*t20-t50-4375.0/4.0*t24-4375.0/12.0*t26+t31+t98+t99+t100+t101
        t109 = 3125.0/2.0*t32
        t110 = 3125.0/2.0*t34
        t112 = 125.0*t5
        t116 = 6875.0/4.0*t22
        t117 = 625.0/4.0*t24
        t119 = 125.0/3.0*t5
        t123 = 625.0/2.0*t22
        t129 = 625.0/12.0*t20
        t132 = 3125.0/4.0*t36
        t133 = 3125.0/12.0*t38
        t134 = -t90+t58+2675.0/12.0*t7-125.0*t11-t93-7375.0/12.0*t15+t129+t63+5625.0/4.0*t24+8125.0/12.0*t26-t33-t99-t132-t133
        t143 = 25.0/6.0*t5
        t148 = 125.0/6.0*t11
        t153 = 50.0/3.0*eta-t70-325.0/2.0*t7+t148+3875.0/12.0*t13+6125.0/12.0*t15-t76-3125.0/4.0*t24-625.0*t26+t35+t100+t133
        t162 = 1375.0/24.0*t13

        values = np.zeros((self.num_shape_functions, len(xi)), dtype=np.float64)

        values[0, :] =  1.0-137.0/12.0*xi-137.0/12.0*eta+375.0/8.0*t3+375.0/4.0*t5+375.0/8.0*t7-2125.0/24.0*t9-2125.0/8.0*t11-2125.0/8.0*t13-2125.0/24.0*t15+t40
        values[1, :] =  t56
        values[2, :] =  t67
        values[3, :] =  t77
        values[4, :] =  -25.0/4.0*xi+1525.0/24.0*t3+t80-5125.0/24.0*t9-t82+6875.0/24.0*t18+t84-t52-t31
        values[5, :] =  xi-125.0/12.0*t3+875.0/24.0*t9-625.0/12.0*t18+t29
        values[6, :] =  t102
        values[7, :] =  250.0*t5-5875.0/6.0*t11-5875.0/6.0*t13+1250.0*t20+2500.0*t22+1250.0*t24-t53-t109-t110-t100
        values[8, :] =  -t112+3625.0/4.0*t11+1125.0/4.0*t13-3125.0/2.0*t20-t116-t117+t66+t109+t99
        values[9, :] =  t119-2125.0/6.0*t11-125.0/3.0*t13+2500.0/3.0*t20+t123-t53-t98
        values[10, :] =  -t80+t82-t84+t31
        values[11, :] =  t134
        values[12, :] =  -t112+1125.0/4.0*t11+3625.0/4.0*t13-t84-t116-3125.0/2.0*t24+t54+t110+t132
        values[13, :] =  125.0/4.0*t5-375.0/2.0*t11-375.0/2.0*t13+t84+t50+t117-t54-t99
        values[14, :] =  -t143+125.0/4.0*t11+t73-t129-t76+t33
        values[15, :] =  t153
        values[16, :] =  t119-125.0/3.0*t11-2125.0/6.0*t13+t123+2500.0/3.0*t24-t55-t100
        values[17, :] =  -t143+t148+125.0/4.0*t13-t76-t64+t35
        values[18, :] =  -25.0/4.0*eta+t80+1525.0/24.0*t7-t162-5125.0/24.0*t15+t117+6875.0/24.0*t26-t37-t101
        values[19, :] =  -t80+t162-t117+t37
        values[20, :] =  eta-125.0/12.0*t7+875.0/24.0*t15-625.0/12.0*t26+t39

        return values


    #  values of the derivatives in xi direction
    
    def gradx(self, xi, eta):
        """
        This method returns the gradient in x-direction of the basis functions at the given (xi, eta) coordinates.
        """
    

        t3, t5, t7, t9, t11, t13, t15, t17, t18, t19, t20, t21, t22, t23
        t24, t25, t26, t27, t29, t31, t35, t37, t38, t39, t40, t41, t43
        t48, t49, t50, t51, t52, t54, t57, t60, t61, t63, t65, t67, t74
        t77, t78, t79, t87, t88, t90, t94, t95, t97, t101, t105, t107
        t117, t120, t131

        t3 = xi*xi
        t5 = xi*eta
        t7 = eta*eta
        t9 = t3*xi
        t11 = t3*eta
        t13 = xi*t7
        t15 = t7*eta
        t17 = t3*t3
        t18 = 3125.0/24.0*t17
        t19 = t9*eta
        t20 = 3125.0/6.0*t19
        t21 = t3*t7
        t22 = 3125.0/4.0*t21
        t23 = xi*t15
        t24 = 3125.0/6.0*t23
        t25 = t7*t7
        t26 = 3125.0/24.0*t25
        t27 = -137.0/12.0+375.0/4.0*xi+375.0/4.0*eta-2125.0/8.0*t3-2125.0/4.0*t5-2125.0/8.0*t7+625.0/2.0*t9+1875.0/2.0*t11+1875.0/2.0*t13+625.0/2.0*t15-t18-t20-t22-t24-t26
        t29 = 1925.0/12.0*eta
        t31 = 8875.0/6.0*t5
        t35 = 4375.0/2.0*t13
        t37 = 15625.0/24.0*t17
        t38 = 6250.0/3.0*t19
        t39 = 9375.0/4.0*t21
        t40 = 3125.0/3.0*t23
        t41 = 25.0-1925.0/6.0*xi-t29+8875.0/8.0*t3+t31+8875.0/24.0*t7-4375.0/3.0*t9-13125.0/4.0*t11-t35-4375.0/12.0*t15+t37+t38+t39+t40+t26
        t43 = 1175.0/12.0*eta
        t48 = 3125.0/2.0*t13
        t49 = 625.0/12.0*t15
        t50 = 15625.0/12.0*t17
        t51 = 3125.0*t19
        t52 = -25.0+2675.0/6.0*xi+t43-7375.0/4.0*t3-t31-125.0*t7+8125.0/3.0*t9+16875.0/4.0*t11+t48+t49-t50-t51-t39-t24
        t54 = 75.0/2.0*eta
        t57 = 125.0/6.0*t7
        t60 = 625.0/2.0*t13
        t61 = 50.0/3.0-325.0*xi-t54+6125.0/4.0*t3+3875.0/6.0*t5+t57-2500.0*t9-9375.0/4.0*t11-t60+t50+t38+t22
        t63 = 25.0/4.0*eta
        t65 = 1375.0/12.0*t5
        t67 = 1875.0/4.0*t11
        t74 = 8875.0/12.0*t7
        t77 = 3125.0/2.0*t21
        t78 = 3125.0/2.0*t23
        t79 = 3125.0/6.0*t25
        t87 = 9375.0/2.0*t21
        t88 = 3125.0*t23
        t90 = 125.0*eta
        t94 = 6875.0/2.0*t13
        t95 = 625.0/4.0*t15
        t97 = 125.0/3.0*eta
        t101 = 625.0*t13
        t105 = 625.0/4.0*t11
        t107 = 3125.0/4.0*t25
        t117 = 25.0/6.0*eta
        t120 = 125.0/3.0*t5
        t131 = t63-1375.0/24.0*t7+t95-t26

        values = np.zeros((self.num_shape_functions, len(xi)), dtype=np.float64)

        values[0, :] =  t27
        values[1, :] =  t41
        values[2, :] =  t52
        values[3, :] =  t61
        values[4, :] =  -25.0/4.0+1525.0/12.0*xi+t63-5125.0/8.0*t3-t65+6875.0/6.0*t9+t67-t37-t20
        values[5, :] =  1.0-125.0/6.0*xi+875.0/8.0*t3-625.0/3.0*t9+t18
        values[6, :] =  -t29+8875.0/12.0*t5+t74-4375.0/4.0*t11-t35-4375.0/4.0*t15+t20+t77+t78+t79
        values[7, :] =  250.0*eta-5875.0/3.0*t5-5875.0/6.0*t7+3750.0*t11+5000.0*t13+1250.0*t15-t38-t87-t88-t79
        values[8, :] =  -t90+3625.0/2.0*t5+1125.0/4.0*t7-9375.0/2.0*t11-t94-t95+t51+t87+t78
        values[9, :] =  t97-2125.0/3.0*t5-125.0/3.0*t7+2500.0*t11+t101-t38-t77
        values[10, :] =  -t63+t65-t67+t20
        values[11, :] =  t43-250.0*t5-t74+t105+t48+5625.0/4.0*t15-t22-t78-t107
        values[12, :] =  -t90+1125.0/2.0*t5+3625.0/4.0*t7-t67-t94-3125.0/2.0*t15+t39+t88+t107
        values[13, :] =  125.0/4.0*eta-375.0*t5-375.0/2.0*t7+t67+t35+t95-t39-t78
        values[14, :] =  -t117+125.0/2.0*t5+t57-t105-t60+t22
        values[15, :] =  -t54+t120+3875.0/12.0*t7-t60-3125.0/4.0*t15+t24+t79
        values[16, :] =  t97-250.0/3.0*t5-2125.0/6.0*t7+t101+2500.0/3.0*t15-t40-t79
        values[17, :] =  -t117+t120+125.0/4.0*t7-t60-t49+t24
        values[18, :] =  t131
        values[19, :] =  -t131
        values[20, :] =  0.0

        return values


    #  values of the derivatives in eta direction
    
    def grady(self, xi, eta):
        """
        This method returns the gradient in y-direction of the basis functions at the given (xi, eta) coordinates.
        """
    

        t3, t5, t7, t9, t11, t13, t15, t17, t18, t19, t20, t21, t22, t23
        t24, t25, t26, t27, t28, t29, t32, t34, t35, t36, t38, t41, t42
        t43, t45, t47, t49, t51, t53, t54, t57, t62, t63, t64, t65, t66
        t73, t74, t76, t80, t81, t83, t87, t92, t95, t96, t97, t106, t110
        t115, t123

        t3 = xi*xi
        t5 = xi*eta
        t7 = eta*eta
        t9 = t3*xi
        t11 = t3*eta
        t13 = xi*t7
        t15 = t7*eta
        t17 = t3*t3
        t18 = 3125.0/24.0*t17
        t19 = t9*eta
        t20 = 3125.0/6.0*t19
        t21 = t3*t7
        t22 = 3125.0/4.0*t21
        t23 = xi*t15
        t24 = 3125.0/6.0*t23
        t25 = t7*t7
        t26 = 3125.0/24.0*t25
        t27 = -137.0/12.0+375.0/4.0*xi+375.0/4.0*eta-2125.0/8.0*t3-2125.0/4.0*t5-2125.0/8.0*t7+625.0/2.0*t9+1875.0/2.0*t11+1875.0/2.0*t13+625.0/2.0*t15-t18-t20-t22-t24-t26
        t28 = 1925.0/12.0*xi
        t29 = 8875.0/12.0*t3
        t32 = 4375.0/2.0*t11
        t34 = 3125.0/6.0*t17
        t35 = 3125.0/2.0*t19
        t36 = 3125.0/2.0*t21
        t38 = 1175.0/12.0*xi
        t41 = 3125.0/2.0*t11
        t42 = 625.0/4.0*t13
        t43 = 3125.0/4.0*t17
        t45 = 75.0/2.0*xi
        t47 = 125.0/3.0*t5
        t49 = 625.0/2.0*t11
        t51 = 25.0/4.0*xi
        t53 = 625.0/4.0*t9
        t54 = t51-1375.0/24.0*t3+t53-t18
        t57 = 8875.0/6.0*t5
        t62 = 3125.0/3.0*t19
        t63 = 9375.0/4.0*t21
        t64 = 6250.0/3.0*t23
        t65 = 15625.0/24.0*t25
        t66 = 25.0-t28-1925.0/6.0*eta+8875.0/24.0*t3+t57+8875.0/8.0*t7-4375.0/12.0*t9-t32-13125.0/4.0*t13-4375.0/3.0*t15+t18+t62+t63+t64+t65
        t73 = 3125.0*t19
        t74 = 9375.0/2.0*t21
        t76 = 125.0*xi
        t80 = 6875.0/2.0*t11
        t81 = 1875.0/4.0*t13
        t83 = 125.0/3.0*xi
        t87 = 625.0*t11
        t92 = 625.0/12.0*t9
        t95 = 3125.0*t23
        t96 = 15625.0/12.0*t25
        t97 = -25.0+t38+2675.0/6.0*eta-125.0*t3-t57-7375.0/4.0*t7+t92+t41+16875.0/4.0*t13+8125.0/3.0*t15-t20-t63-t95-t96
        t106 = 25.0/6.0*xi
        t110 = 125.0/6.0*t3
        t115 = 50.0/3.0-t45-325.0*eta+t110+3875.0/6.0*t5+6125.0/4.0*t7-t49-9375.0/4.0*t13-2500.0*t15+t22+t64+t96
        t123 = 1375.0/12.0*t5

        values = np.zeros((self.num_shape_functions, len(xi)), dtype=np.float64)

        values[0, :] =  t27
        values[1, :] =  -t28+t29+8875.0/12.0*t5-4375.0/4.0*t9-t32-4375.0/4.0*t13+t34+t35+t36+t24
        values[2, :] =  t38-t29-250.0*t5+5625.0/4.0*t9+t41+t42-t43-t35-t22
        values[3, :] =  -t45+3875.0/12.0*t3+t47-3125.0/4.0*t9-t49+t34+t20
        values[4, :] =  t54
        values[5, :] =  0.0
        values[6, :] =  t66
        values[7, :] =  250.0*xi-5875.0/6.0*t3-5875.0/3.0*t5+1250.0*t9+5000.0*t11+3750.0*t13-t34-t73-t74-t64
        values[8, :] =  -t76+3625.0/4.0*t3+1125.0/2.0*t5-3125.0/2.0*t9-t80-t81+t43+t73+t63
        values[9, :] =  t83-2125.0/6.0*t3-250.0/3.0*t5+2500.0/3.0*t9+t87-t34-t62
        values[10, :] =  -t54
        values[11, :] =  t97
        values[12, :] =  -t76+1125.0/4.0*t3+3625.0/2.0*t5-t53-t80-9375.0/2.0*t13+t35+t74+ t95
        values[13, :] =  125.0/4.0*xi-375.0/2.0*t3-375.0*t5+t53+t32+t81-t35-t63
        values[14, :] =  -t106+125.0/4.0*t3+t47-t92-t49+t20
        values[15, :] =  t115
        values[16, :] =  t83-125.0/3.0*t3-2125.0/3.0*t5+t87+2500.0*t13-t36-t64
        values[17, :] =  -t106+t110+125.0/2.0*t5-t49-t42+t22
        values[18, :] =  -25.0/4.0+t51+1525.0/12.0*eta-t123-5125.0/8.0*t7+t81+6875.0/6.0*t15-t24-t65
        values[19, :] =  -t51+t123-t81+t24
        values[20, :] =  1.0-125.0/6.0*eta+875.0/8.0*t7-625.0/3.0*t15+t26

        return values


    #  values of the derivatives in xi-xi direction
    
    def gradxx(self, xi, eta):
        """
        This method returns the double gradient in x-direction of the basis functions at the given (xi, eta) coordinates.
        """
    

        t3, t5, t7, t9, t10, t11, t12, t13, t14, t15, t16, t19, t22, t23
        t24, t25, t26, t31, t32, t33, t39, t42, t44, t51, t52, t57, t58
        t62, t66, t70, t79

        t3 = xi*xi
        t5 = xi*eta
        t7 = eta*eta
        t9 = t3*xi
        t10 = 3125.0/6.0*t9
        t11 = t3*eta
        t12 = 3125.0/2.0*t11
        t13 = xi*t7
        t14 = 3125.0/2.0*t13
        t15 = t7*eta
        t16 = 3125.0/6.0*t15
        t19 = 8875.0/6.0*eta
        t22 = 4375.0/2.0*t7
        t23 = 15625.0/6.0*t9
        t24 = 6250.0*t11
        t25 = 9375.0/2.0*t13
        t26 = 3125.0/3.0*t15
        t31 = 3125.0/2.0*t7
        t32 = 15625.0/3.0*t9
        t33 = 9375.0*t11
        t39 = 625.0/2.0*t7
        t42 = 1375.0/12.0*eta
        t44 = 1875.0/2.0*t5
        t51 = 3125.0*t13
        t52 = 3125.0/2.0*t15
        t57 = 9375.0*t13
        t58 = 3125.0*t15
        t62 = 6875.0/2.0*t7
        t66 = 625.0*t7
        t70 = 625.0/2.0*t5
        t79 = 125.0/3.0*eta-t39+t16

        values = np.zeros((self.num_shape_functions, len(xi)), dtype=np.float64)

        values[0, :] =  375.0/4.0-2125.0/4.0*xi-2125.0/4.0*eta+1875.0/2.0*t3+1875.0*t5+1875.0/2.0*t7-t10-t12-t14-t16
        values[1, :] =  -1925.0/6.0+8875.0/4.0*xi+t19-4375.0*t3-13125.0/2.0*t5-t22+t23+t24+t25+t26
        values[2, :] =  2675.0/6.0-7375.0/2.0*xi-t19+8125.0*t3+16875.0/2.0*t5+t31-t32-t33-t25-t16
        values[3, :] =  -325.0+6125.0/2.0*xi+3875.0/6.0*eta-7500.0*t3-9375.0/2.0*t5-t39+t32+t24+t14
        values[4, :] =  1525.0/12.0-5125.0/4.0*xi-t42+6875.0/2.0*t3+t44-t23-t12
        values[5, :] =  -125.0/6.0+875.0/4.0*xi-625.0*t3+t10
        values[6, :] =  8875.0/12.0*eta-4375.0/2.0*t5-t22+t12+t51+t52
        values[7, :] =  -5875.0/3.0*eta+7500.0*t5+5000.0*t7-t24-t57-t58
        values[8, :] =  3625.0/2.0*eta-9375.0*t5-t62+t33+t57+t52
        values[9, :] =  -2125.0/3.0*eta+5000.0*t5+t66-t24-t51
        values[10, :] =  t42-t44+t12
        values[11, :] =  -250.0*eta+t70+t31-t14-t52
        values[12, :] =  1125.0/2.0*eta-t44-t62+t25+t58
        values[13, :] =  -375.0*eta+t44+t22-t25-t52
        values[14, :] =  125.0/2.0*eta-t70-t39+t14
        values[15, :] =  t79
        values[16, :] =  -250.0/3.0*eta+t66-t26
        values[17, :] =  t79
        values[18, :] =  0.0
        values[19, :] =  0.0
        values[20, :] =  0.0

        return values


    #  values of the derivatives in xi-eta direction
    
    def gradxy(self, xi, eta):
        """
        This method returns the  gradxy of the basis functions at the given (xi, eta) coordinates.
        """
    

        t3, t5, t7, t9, t10, t11, t12, t13, t14, t15, t16, t18, t21, t23
        t24, t25, t29, t30, t31, t34, t36, t39, t40, t42, t45, t46, t47
        t54, t55, t60, t61, t66, t69, t71, t82, t93

        t3 = xi*xi
        t5 = xi*eta
        t7 = eta*eta
        t9 = t3*xi
        t10 = 3125.0/6.0*t9
        t11 = t3*eta
        t12 = 3125.0/2.0*t11
        t13 = xi*t7
        t14 = 3125.0/2.0*t13
        t15 = t7*eta
        t16 = 3125.0/6.0*t15
        t18 = 8875.0/6.0*xi
        t21 = 4375.0*t5
        t23 = 6250.0/3.0*t9
        t24 = 9375.0/2.0*t11
        t25 = 3125.0*t13
        t29 = 3125.0*t5
        t30 = 625.0/4.0*t7
        t31 = 3125.0*t9
        t34 = 125.0/3.0*eta
        t36 = 625.0*t5
        t39 = 1875.0/4.0*t3
        t40 = 25.0/4.0-1375.0/12.0*xi+t39-t10
        t42 = 8875.0/6.0*eta
        t45 = 3125.0*t11
        t46 = 9375.0/2.0*t13
        t47 = 6250.0/3.0*t15
        t54 = 9375.0*t11
        t55 = 9375.0*t13
        t60 = 6875.0*t5
        t61 = 1875.0/4.0*t7
        t66 = 1250.0*t5
        t69 = 625.0/4.0*t3
        t71 = 3125.0*t15
        t82 = 125.0/3.0*xi
        t93 = 25.0/4.0-1375.0/12.0*eta+t61-t16

        values = np.zeros((self.num_shape_functions, len(xi)), dtype=np.float64)

        values[0, :] =  375.0/4.0-2125.0/4.0*xi-2125.0/4.0*eta+1875.0/2.0*t3+1875.0*t5+1875.0/2.0*t7-t10-t12-t14-t16
        values[1, :] =  -1925.0/12.0+t18+8875.0/12.0*eta-13125.0/4.0*t3-t21-4375.0/4.0*t7+t23+t24+t25+t16
        values[2, :] =  1175.0/12.0-t18-250.0*eta+16875.0/4.0*t3+t29+t30-t31-t24-t14
        values[3, :] =  -75.0/2.0+3875.0/6.0*xi+t34-9375.0/4.0*t3-t36+t23+t12
        values[4, :] =  t40
        values[5, :] =  0.0
        values[6, :] =  -1925.0/12.0+8875.0/12.0*xi+t42-4375.0/4.0*t3-t21-13125.0/4.0*t7+t10+t45+t46+t47
        values[7, :] =  250.0-5875.0/3.0*xi-5875.0/3.0*eta+3750.0*t3+10000.0*t5+3750.0*t7-t23-t54-t55-t47
        values[8, :] =  -125.0+3625.0/2.0*xi+1125.0/2.0*eta-9375.0/2.0*t3-t60-t61+t31+t54+t46
        values[9, :] =  125.0/3.0-2125.0/3.0*xi-250.0/3.0*eta+2500.0*t3+t66-t23-t45
        values[10, :] =  -t40
        values[11, :] =  1175.0/12.0-250.0*xi-t42+t69+t29+16875.0/4.0*t7-t12-t46-t71
        values[12, :] =  -125.0+1125.0/2.0*xi+3625.0/2.0*eta-t39-t60-9375.0/2.0*t7+t24+t55+t71
        values[13, :] =  125.0/4.0-375.0*xi-375.0*eta+t39+t21+t61-t24-t46
        values[14, :] =  -25.0/6.0+125.0/2.0*xi+t34-t69-t36+t12
        values[15, :] =  -75.0/2.0+t82+3875.0/6.0*eta-t36-9375.0/4.0*t7+t14+t47
        values[16, :] =  125.0/3.0-250.0/3.0*xi-2125.0/3.0*eta+t66+2500.0*t7-t25-t47
        values[17, :] =  -25.0/6.0+t82+125.0/2.0*eta-t36-t30+t14
        values[18, :] =  t93
        values[19, :] =  -t93
        values[20, :] =  0.0

        return values


    #  values of the derivatives in eta-eta direction
    
    def gradyy(self, xi, eta):
        """
        This method returns the double gradient in y-direction of the basis functions at the given (xi, eta) coordinates.
        """
    

        t3, t5, t7, t9, t10, t11, t12, t13, t14, t15, t16, t19, t21, t22
        t25, t26, t29, t30, t31, t35, t36, t37, t38, t43, t44, t47, t48
        t51, t56, t57, t74

        t3 = xi*xi
        t5 = xi*eta
        t7 = eta*eta
        t9 = t3*xi
        t10 = 3125.0/6.0*t9
        t11 = t3*eta
        t12 = 3125.0/2.0*t11
        t13 = xi*t7
        t14 = 3125.0/2.0*t13
        t15 = t7*eta
        t16 = 3125.0/6.0*t15
        t19 = 4375.0/2.0*t3
        t21 = 3125.0/2.0*t9
        t22 = 3125.0*t11
        t25 = 3125.0/2.0*t3
        t26 = 625.0/2.0*t5
        t29 = 625.0/2.0*t3
        t30 = 125.0/3.0*xi-t29+t10
        t31 = 8875.0/6.0*xi
        t35 = 3125.0/3.0*t9
        t36 = 9375.0/2.0*t11
        t37 = 6250.0*t13
        t38 = 15625.0/6.0*t15
        t43 = 3125.0*t9
        t44 = 9375.0*t11
        t47 = 6875.0/2.0*t3
        t48 = 1875.0/2.0*t5
        t51 = 625.0*t3
        t56 = 9375.0*t13
        t57 = 15625.0/3.0*t15
        t74 = 1375.0/12.0*xi

        values = np.zeros((self.num_shape_functions, len(xi)), dtype=np.float64)

        values[0, :] =  375.0/4.0-2125.0/4.0*xi-2125.0/4.0*eta+1875.0/2.0*t3+1875.0*t5+1875.0/2.0*t7-t10-t12-t14-t16
        values[1, :] =  8875.0/12.0*xi-t19-4375.0/2.0*t5+t21+t22+t14
        values[2, :] =  -250.0*xi+t25+t26-t21-t12
        values[3, :] =  t30
        values[4, :] =  0.0
        values[5, :] =  0.0
        values[6, :] =  -1925.0/6.0+t31+8875.0/4.0*eta-t19-13125.0/2.0*t5-4375.0*t7+t35+t36+t37+t38
        values[7, :] =  -5875.0/3.0*xi+5000.0*t3+7500.0*t5-t43-t44-t37
        values[8, :] =  1125.0/2.0*xi-t47-t48+t43+t36
        values[9, :] =  -250.0/3.0*xi+t51-t35
        values[10, :] =  0.0
        values[11, :] =  2675.0/6.0-t31-7375.0/2.0*eta+t25+16875.0/2.0*t5+8125.0*t7-t10-t36-t56-t57
        values[12, :] =  3625.0/2.0*xi-t47-9375.0*t5+t21+t44+t56
        values[13, :] =  -375.0*xi+t19+t48-t21-t36
        values[14, :] =  t30
        values[15, :] =  -325.0+3875.0/6.0*xi+6125.0/2.0*eta-t29-9375.0/2.0*t5-7500.0*t7+t12+t37+t57
        values[16, :] =  -2125.0/3.0*xi+t51+5000.0*t5-t22-t37
        values[17, :] =  125.0/2.0*xi-t29-t26+t12
        values[18, :] =  1525.0/12.0-t74-5125.0/4.0*eta+t48+6875.0/2.0*t7-t14-t38
        values[19, :] =  t74-t48+t14
        values[20, :] =  -125.0/6.0+875.0/4.0*eta-625.0*t7+t16

        return values



